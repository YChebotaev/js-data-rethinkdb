{"version":3,"file":"js-data-rethinkdb.js","sources":["../src/index.js"],"sourcesContent":["let rethinkdbdash = require('rethinkdbdash')\nimport {utils} from 'js-data'\nconst {\n  addHiddenPropsToTarget,\n  fillIn,\n  forEachRelation,\n  forOwn,\n  get,\n  isArray,\n  isObject,\n  isString,\n  isUndefined,\n  resolve\n} = utils\n\nconst underscore = require('mout/string/underscore')\n\nconst reserved = [\n  'orderBy',\n  'sort',\n  'limit',\n  'offset',\n  'skip',\n  'where'\n]\n\nconst unique = function (array) {\n  const seen = {}\n  const final = []\n  array.forEach(function (item) {\n    if (item in seen) {\n      return\n    }\n    final.push(item)\n    seen[item] = 0\n  })\n  return final\n}\n\nconst noop = function (...args) {\n  const self = this\n  const opts = args[args.length - 1]\n  self.dbg(opts.op, ...args)\n  return resolve()\n}\n\nconst noop2 = function (...args) {\n  const self = this\n  const opts = args[args.length - 2]\n  self.dbg(opts.op, ...args)\n  return resolve()\n}\n\nconst DEFAULTS = {\n  /**\n   * TODO\n   *\n   * @name RethinkDBAdapter#authKey\n   * @type {string}\n   */\n  authKey: '',\n\n  /**\n   * TODO\n   *\n   * @name RethinkDBAdapter#bufferSize\n   * @type {number}\n   * @default 10\n   */\n  bufferSize: 10,\n\n  /**\n   * TODO\n   *\n   * @name RethinkDBAdapter#db\n   * @type {string}\n   * @default \"test\"\n   */\n  db: 'test',\n\n  /**\n   * TODO\n   *\n   * @name RethinkDBAdapter#debug\n   * @type {boolean}\n   * @default false\n   */\n  debug: false,\n\n  /**\n   * TODO\n   *\n   * @name RethinkDBAdapter#host\n   * @type {string}\n   * @default \"localhost\"\n   */\n  host: 'localhost',\n\n  /**\n   * TODO\n   *\n   * @name RethinkDBAdapter#min\n   * @type {number}\n   * @default 10\n   */\n  min: 10,\n\n  /**\n   * TODO\n   *\n   * @name RethinkDBAdapter#max\n   * @type {number}\n   * @default 50\n   */\n  max: 50,\n\n  /**\n   * TODO\n   *\n   * @name RethinkDBAdapter#port\n   * @type {number}\n   * @default 10\n   */\n  port: 28015,\n\n  /**\n   * TODO\n   *\n   * @name RethinkDBAdapter#raw\n   * @type {boolean}\n   * @default false\n   */\n  raw: false,\n\n  /**\n   * TODO\n   *\n   * @name RethinkDBAdapter#returnDeletedIds\n   * @type {boolean}\n   * @default false\n   */\n  returnDeletedIds: false\n}\n\n/**\n * RethinkDBAdapter class.\n *\n * @example\n * import {DS} from 'js-data'\n * import RethinkDBAdapter from 'js-data-rethinkdb'\n * const store = new DS()\n * const adapter = new RethinkDBAdapter()\n * store.registerAdapter('rethinkdb', adapter, { 'default': true })\n *\n * @class RethinkDBAdapter\n * @param {Object} [opts] Configuration opts.\n * @param {string} [opts.host='localhost'] TODO\n * @param {number} [opts.port=28015] TODO\n * @param {string} [opts.authKey=''] TODO\n * @param {string} [opts.db='test'] TODO\n * @param {number} [opts.min=10] TODO\n * @param {number} [opts.max=50] TODO\n * @param {number} [opts.bufferSize=10] TODO\n */\nexport default function RethinkDBAdapter (opts) {\n  const self = this\n  opts || (opts = {})\n  fillIn(opts, DEFAULTS)\n  fillIn(self, opts)\n  self.r = rethinkdbdash(opts)\n  self.databases = {}\n  self.tables = {}\n  self.indices = {}\n}\n\naddHiddenPropsToTarget(RethinkDBAdapter.prototype, {\n  _handleErrors (cursor) {\n    if (cursor && cursor.errors > 0) {\n      if (cursor.first_error) {\n        throw new Error(cursor.first_error)\n      }\n      throw new Error('Unknown RethinkDB Error')\n    }\n  },\n  /**\n   * @name RethinkDBAdapter#afterCreate\n   * @method\n   */\n  afterCreate: noop2,\n\n  /**\n   * @name RethinkDBAdapter#afterCreateMany\n   * @method\n   */\n  afterCreateMany: noop2,\n\n  /**\n   * @name RethinkDBAdapter#afterDestroy\n   * @method\n   */\n  afterDestroy: noop2,\n\n  /**\n   * @name RethinkDBAdapter#afterDestroyAll\n   * @method\n   */\n  afterDestroyAll: noop2,\n\n  /**\n   * @name RethinkDBAdapter#afterFind\n   * @method\n   */\n  afterFind: noop2,\n\n  /**\n   * @name RethinkDBAdapter#afterFindAll\n   * @method\n   */\n  afterFindAll: noop2,\n\n  /**\n   * @name RethinkDBAdapter#afterUpdate\n   * @method\n   */\n  afterUpdate: noop2,\n\n  /**\n   * @name RethinkDBAdapter#afterUpdateAll\n   * @method\n   */\n  afterUpdateAll: noop2,\n\n  /**\n   * @name RethinkDBAdapter#afterUpdateMany\n   * @method\n   */\n  afterUpdateMany: noop2,\n\n  /**\n   * @name RethinkDBAdapter#beforeCreate\n   * @method\n   */\n  beforeCreate: noop,\n\n  /**\n   * @name RethinkDBAdapter#beforeCreateMany\n   * @method\n   */\n  beforeCreateMany: noop,\n\n  /**\n   * @name RethinkDBAdapter#beforeDestroy\n   * @method\n   */\n  beforeDestroy: noop,\n\n  /**\n   * @name RethinkDBAdapter#beforeDestroyAll\n   * @method\n   */\n  beforeDestroyAll: noop,\n\n  /**\n   * @name RethinkDBAdapter#beforeFind\n   * @method\n   */\n  beforeFind: noop,\n\n  /**\n   * @name RethinkDBAdapter#beforeFindAll\n   * @method\n   */\n  beforeFindAll: noop,\n\n  /**\n   * @name RethinkDBAdapter#beforeUpdate\n   * @method\n   */\n  beforeUpdate: noop,\n\n  /**\n   * @name RethinkDBAdapter#beforeUpdateAll\n   * @method\n   */\n  beforeUpdateAll: noop,\n\n  /**\n   * @name RethinkDBAdapter#beforeUpdateMany\n   * @method\n   */\n  beforeUpdateMany: noop,\n\n  /**\n   * @name RethinkDBAdapter#dbg\n   * @method\n   */\n  dbg (...args) {\n    this.log('debug', ...args)\n  },\n\n  selectDb (opts) {\n    return this.r.db(isUndefined(opts.db) ? this.db : opts.db)\n  },\n\n  selectTable (Resource, opts) {\n    return this.selectDb(opts).table(Resource.table || underscore(Resource.name))\n  },\n\n  filterSequence (sequence, params) {\n    let r = this.r\n    params = params || {}\n    params.where = params.where || {}\n    params.orderBy = params.orderBy || params.sort\n    params.skip = params.skip || params.offset\n\n    Object.keys(params).forEach(function (k) {\n      let v = params[k]\n      if (reserved.indexOf(k) === -1) {\n        if (isObject(v)) {\n          params.where[k] = v\n        } else {\n          params.where[k] = {\n            '==': v\n          }\n        }\n        delete params[k]\n      }\n    })\n\n    let query = sequence\n\n    if (Object.keys(params.where).length !== 0) {\n      query = query.filter(function (row) {\n        let subQuery\n        forOwn(params.where, function (criteria, field) {\n          if (!isObject(criteria)) {\n            criteria = { '==': criteria }\n          }\n          forOwn(criteria, function (v, op) {\n            if (op === '==' || op === '===') {\n              subQuery = subQuery ? subQuery.and(row(field).default(null).eq(v)) : row(field).default(null).eq(v)\n            } else if (op === '!=' || op === '!==') {\n              subQuery = subQuery ? subQuery.and(row(field).default(null).ne(v)) : row(field).default(null).ne(v)\n            } else if (op === '>') {\n              subQuery = subQuery ? subQuery.and(row(field).default(null).gt(v)) : row(field).default(null).gt(v)\n            } else if (op === '>=') {\n              subQuery = subQuery ? subQuery.and(row(field).default(null).ge(v)) : row(field).default(null).ge(v)\n            } else if (op === '<') {\n              subQuery = subQuery ? subQuery.and(row(field).default(null).lt(v)) : row(field).default(null).lt(v)\n            } else if (op === '<=') {\n              subQuery = subQuery ? subQuery.and(row(field).default(null).le(v)) : row(field).default(null).le(v)\n            } else if (op === 'isectEmpty') {\n              subQuery = subQuery ? subQuery.and(row(field).default([]).setIntersection(r.expr(v).default([])).count().eq(0)) : row(field).default([]).setIntersection(r.expr(v).default([])).count().eq(0)\n            } else if (op === 'isectNotEmpty') {\n              subQuery = subQuery ? subQuery.and(row(field).default([]).setIntersection(r.expr(v).default([])).count().ne(0)) : row(field).default([]).setIntersection(r.expr(v).default([])).count().ne(0)\n            } else if (op === 'in') {\n              subQuery = subQuery ? subQuery.and(r.expr(v).default(r.expr([])).contains(row(field).default(null))) : r.expr(v).default(r.expr([])).contains(row(field).default(null))\n            } else if (op === 'notIn') {\n              subQuery = subQuery ? subQuery.and(r.expr(v).default(r.expr([])).contains(row(field).default(null)).not()) : r.expr(v).default(r.expr([])).contains(row(field).default(null)).not()\n            } else if (op === 'contains') {\n              subQuery = subQuery ? subQuery.and(row(field).default([]).contains(v)) : row(field).default([]).contains(v)\n            } else if (op === 'notContains') {\n              subQuery = subQuery ? subQuery.and(row(field).default([]).contains(v).not()) : row(field).default([]).contains(v).not()\n            } else if (op === '|==' || op === '|===') {\n              subQuery = subQuery ? subQuery.or(row(field).default(null).eq(v)) : row(field).default(null).eq(v)\n            } else if (op === '|!=' || op === '|!==') {\n              subQuery = subQuery ? subQuery.or(row(field).default(null).ne(v)) : row(field).default(null).ne(v)\n            } else if (op === '|>') {\n              subQuery = subQuery ? subQuery.or(row(field).default(null).gt(v)) : row(field).default(null).gt(v)\n            } else if (op === '|>=') {\n              subQuery = subQuery ? subQuery.or(row(field).default(null).ge(v)) : row(field).default(null).ge(v)\n            } else if (op === '|<') {\n              subQuery = subQuery ? subQuery.or(row(field).default(null).lt(v)) : row(field).default(null).lt(v)\n            } else if (op === '|<=') {\n              subQuery = subQuery ? subQuery.or(row(field).default(null).le(v)) : row(field).default(null).le(v)\n            } else if (op === '|isectEmpty') {\n              subQuery = subQuery ? subQuery.or(row(field).default([]).setIntersection(r.expr(v).default([])).count().eq(0)) : row(field).default([]).setIntersection(r.expr(v).default([])).count().eq(0)\n            } else if (op === '|isectNotEmpty') {\n              subQuery = subQuery ? subQuery.or(row(field).default([]).setIntersection(r.expr(v).default([])).count().ne(0)) : row(field).default([]).setIntersection(r.expr(v).default([])).count().ne(0)\n            } else if (op === '|in') {\n              subQuery = subQuery ? subQuery.or(r.expr(v).default(r.expr([])).contains(row(field).default(null))) : r.expr(v).default(r.expr([])).contains(row(field).default(null))\n            } else if (op === '|notIn') {\n              subQuery = subQuery ? subQuery.or(r.expr(v).default(r.expr([])).contains(row(field).default(null)).not()) : r.expr(v).default(r.expr([])).contains(row(field).default(null)).not()\n            } else if (op === '|contains') {\n              subQuery = subQuery ? subQuery.or(row(field).default([]).contains(v)) : row(field).default([]).contains(v)\n            } else if (op === '|notContains') {\n              subQuery = subQuery ? subQuery.or(row(field).default([]).contains(v).not()) : row(field).default([]).contains(v).not()\n            }\n          })\n        })\n        return subQuery || true\n      })\n    }\n\n    if (params.orderBy) {\n      if (isString(params.orderBy)) {\n        params.orderBy = [\n          [params.orderBy, 'asc']\n        ]\n      }\n      for (var i = 0; i < params.orderBy.length; i++) {\n        if (isString(params.orderBy[i])) {\n          params.orderBy[i] = [params.orderBy[i], 'asc']\n        }\n        query = (params.orderBy[i][1] || '').toUpperCase() === 'DESC' ? query.orderBy(r.desc(params.orderBy[i][0])) : query.orderBy(params.orderBy[i][0])\n      }\n    }\n\n    if (params.skip) {\n      query = query.skip(+params.skip)\n    }\n\n    if (params.limit) {\n      query = query.limit(+params.limit)\n    }\n\n    return query\n  },\n\n  waitForDb (opts) {\n    const self = this\n    opts || (opts = {})\n    const db = isUndefined(opts.db) ? self.db : opts.db\n    if (!self.databases[db]) {\n      self.databases[db] = self.r.branch(\n        self.r.dbList().contains(db),\n        true,\n        self.r.dbCreate(db)\n      ).run()\n    }\n    return self.databases[db]\n  },\n\n  /**\n   * Create a new record.\n   *\n   * @name RethinkDBAdapter#create\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {Object} props The record to be created.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] TODO\n   * @return {Promise}\n   */\n  create (mapper, props, opts) {\n    const self = this\n    let op\n    props || (props = {})\n    opts || (opts = {})\n\n    return self.waitForTable(mapper.table || underscore(mapper.name), opts).then(function () {\n      // beforeCreate lifecycle hook\n      op = opts.op = 'beforeCreate'\n      return resolve(self[op](mapper, props, opts))\n    }).then(function (_props) {\n      // Allow for re-assignment from lifecycle hook\n      _props = isUndefined(_props) ? props : _props\n      return self.selectTable(mapper, opts).insert(_props, { returnChanges: true }).run()\n    }).then(function (cursor) {\n      self._handleErrors(cursor)\n      let record\n      if (cursor && cursor.changes && cursor.changes.length && cursor.changes[0].new_val) {\n        record = cursor.changes[0].new_val\n      }\n      // afterCreate lifecycle hook\n      op = opts.op = 'afterCreate'\n      return self[op](mapper, props, opts, record).then(function (_record) {\n        // Allow for re-assignment from lifecycle hook\n        record = isUndefined(_record) ? record : _record\n        const result = {}\n        fillIn(result, cursor)\n        result.data = record\n        result.created = record ? 1 : 0\n        return self.getRaw(opts) ? result : result.data\n      })\n    })\n  },\n\n  /**\n   * Create multiple records in a single batch.\n   *\n   * @name RethinkDBAdapter#createMany\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {Object} props The records to be created.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] TODO\n   * @return {Promise}\n   */\n  createMany (mapper, props, opts) {\n    const self = this\n    let op\n    props || (props = {})\n    opts || (opts = {})\n\n    return self.waitForTable(mapper.table || underscore(mapper.name), opts).then(function () {\n      // beforeCreateMany lifecycle hook\n      op = opts.op = 'beforeCreateMany'\n      return resolve(self[op](mapper, props, opts))\n    }).then(function (_props) {\n      // Allow for re-assignment from lifecycle hook\n      _props = isUndefined(_props) ? props : _props\n      return self.selectTable(mapper, opts).insert(_props, { returnChanges: true }).run()\n    }).then(function (cursor) {\n      self._handleErrors(cursor)\n      let records = []\n      if (cursor && cursor.changes && cursor.changes.length && cursor.changes) {\n        records = cursor.changes.map(function (change) {\n          return change.new_val\n        })\n      }\n      // afterCreateMany lifecycle hook\n      op = opts.op = 'afterCreateMany'\n      return self[op](mapper, props, opts, records).then(function (_records) {\n        // Allow for re-assignment from lifecycle hook\n        records = isUndefined(_records) ? records : _records\n        const result = {}\n        fillIn(result, cursor)\n        result.data = records\n        result.created = records.length\n        return self.getRaw(opts) ? result : result.data\n      })\n    })\n  },\n\n  /**\n   * Destroy the record with the given primary key.\n   *\n   * @name RethinkDBAdapter#destroy\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {(string|number)} id Primary key of the record to destroy.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] TODO\n   * @param {boolean} [opts.returnDeletedIds=false] Whether to return the\n   * primary keys of any deleted records.\n   * @return {Promise}\n   */\n  destroy (mapper, id, opts) {\n    const self = this\n    let op\n    opts || (opts = {})\n    const returnDeletedIds = isUndefined(opts.returnDeletedIds) ? self.returnDeletedIds : !!opts.returnDeletedIds\n\n    return self.waitForTable(mapper.table || underscore(mapper.name), opts).then(function () {\n      // beforeDestroy lifecycle hook\n      op = opts.op = 'beforeDestroy'\n      return resolve(self[op](mapper, id, opts))\n    }).then(function () {\n      op = opts.op = 'destroy'\n      self.dbg(op, id, opts)\n      return self.selectTable(mapper, opts).get(id).delete().run()\n    }).then(function (cursor) {\n      let deleted = 0\n      if (cursor && cursor.deleted) {\n        deleted = cursor.deleted\n      }\n      // afterDestroy lifecycle hook\n      op = opts.op = 'afterDestroy'\n      return resolve(self[op](mapper, id, opts, deleted ? id : undefined)).then(function (_id) {\n        // Allow for re-assignment from lifecycle hook\n        id = isUndefined(_id) && returnDeletedIds ? id : _id\n        const result = {}\n        fillIn(result, cursor)\n        result.data = deleted ? id : undefined\n        return self.getRaw(opts) ? result : result.data\n      })\n    })\n  },\n\n  /**\n   * Destroy the records that match the selection query.\n   *\n   * @name RethinkDBAdapter#destroyAll\n   * @method\n   * @param {Object} mapper the mapper.\n   * @param {Object} [query] Selection query.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] TODO\n   * @param {boolean} [opts.returnDeletedIds=false] Whether to return the\n   * primary keys of any deleted records.\n   * @return {Promise}\n   */\n  destroyAll (mapper, query, opts) {\n    const self = this\n    const idAttribute = mapper.idAttribute\n    let op\n    query || (query = {})\n    opts || (opts = {})\n    const returnDeletedIds = isUndefined(opts.returnDeletedIds) ? self.returnDeletedIds : !!opts.returnDeletedIds\n\n    return self.waitForTable(mapper.table || underscore(mapper.name), opts).then(function () {\n      // beforeDestroyAll lifecycle hook\n      op = opts.op = 'beforeDestroyAll'\n      return resolve(self[op](mapper, query, opts))\n    }).then(function () {\n      op = opts.op = 'destroyAll'\n      self.dbg(op, query, opts)\n      return self\n        .filterSequence(self.selectTable(mapper, opts), query)\n        .delete({ returnChanges: returnDeletedIds })\n        .merge(function (cursor) {\n          return {\n            changes: cursor('changes').default([]).map(function (record) {\n              return record('old_val').default({})(idAttribute).default({})\n            }).filter(function (id) {\n              return id\n            })\n          }\n        })\n        .run()\n    }).then(function (cursor) {\n      let deletedIds\n      if (cursor && cursor.changes && returnDeletedIds) {\n        deletedIds = cursor.changes\n        delete cursor.changes\n      }\n      // afterDestroyAll lifecycle hook\n      op = opts.op = 'afterDestroyAll'\n      return resolve(self[op](mapper, query, opts, deletedIds)).then(function (_deletedIds) {\n        // Allow for re-assignment from lifecycle hook\n        deletedIds = isUndefined(_deletedIds) ? deletedIds : _deletedIds\n        const result = {}\n        fillIn(result, cursor)\n        result.data = deletedIds\n        return self.getRaw(opts) ? result : result.data\n      })\n    })\n  },\n\n  /**\n   * TODO\n   *\n   * There may be reasons why you may want to override this method, like when\n   * the id of the parent doesn't exactly match up to the key on the child.\n   *\n   * @name RethinkDBAdapter#makeHasManyForeignKey\n   * @method\n   * @return {*}\n   */\n  makeHasManyForeignKey (Resource, def, record) {\n    return def.getForeignKey(record)\n  },\n\n  /**\n   * TODO\n   *\n   * @name RethinkDBAdapter#loadHasMany\n   * @method\n   * @return {Promise}\n   */\n  loadHasMany (Resource, def, records, __opts) {\n    const self = this\n    let singular = false\n\n    if (isObject(records) && !isArray(records)) {\n      singular = true\n      records = [records]\n    }\n    const IDs = records.map(function (record) {\n      return self.makeHasManyForeignKey(Resource, def, record)\n    })\n    const query = {}\n    const criteria = query[def.foreignKey] = {}\n    if (singular) {\n      // more efficient query when we only have one record\n      criteria['=='] = IDs[0]\n    } else {\n      criteria['in'] = IDs.filter(function (id) {\n        return id\n      })\n    }\n    return self.findAll(def.getRelation(), query, __opts).then(function (relatedItems) {\n      records.forEach(function (record) {\n        let attached = []\n        // avoid unneccesary iteration when we only have one record\n        if (singular) {\n          attached = relatedItems\n        } else {\n          relatedItems.forEach(function (relatedItem) {\n            if (get(relatedItem, def.foreignKey) === record[Resource.idAttribute]) {\n              attached.push(relatedItem)\n            }\n          })\n        }\n        def.setLocalField(record, attached)\n      })\n    })\n  },\n\n  /**\n   * TODO\n   *\n   * @name RethinkDBAdapter#loadHasOne\n   * @method\n   * @return {Promise}\n   */\n  loadHasOne (Resource, def, records, __opts) {\n    if (isObject(records) && !isArray(records)) {\n      records = [records]\n    }\n    return this.loadHasMany(Resource, def, records, __opts).then(function () {\n      records.forEach(function (record) {\n        const relatedData = def.getLocalField(record)\n        if (isArray(relatedData) && relatedData.length) {\n          def.setLocalField(record, relatedData[0])\n        }\n      })\n    })\n  },\n\n  /**\n   * TODO\n   *\n   * @name RethinkDBAdapter#makeBelongsToForeignKey\n   * @method\n   * @return {*}\n   */\n  makeBelongsToForeignKey (Resource, def, record) {\n    return def.getForeignKey(record)\n  },\n\n  /**\n   * TODO\n   *\n   * @name RethinkDBAdapter#loadBelongsTo\n   * @method\n   * @return {Promise}\n   */\n  loadBelongsTo (mapper, def, records, __opts) {\n    const self = this\n    const relationDef = def.getRelation()\n\n    if (isObject(records) && !isArray(records)) {\n      const record = records\n      return self.find(relationDef, self.makeBelongsToForeignKey(mapper, def, record), __opts).then(function (relatedItem) {\n        def.setLocalField(record, relatedItem)\n      })\n    } else {\n      const keys = records.map(function (record) {\n        return self.makeBelongsToForeignKey(mapper, def, record)\n      }).filter(function (key) {\n        return key\n      })\n      return self.findAll(relationDef, {\n        where: {\n          [relationDef.idAttribute]: {\n            'in': keys\n          }\n        }\n      }, __opts).then(function (relatedItems) {\n        records.forEach(function (record) {\n          relatedItems.forEach(function (relatedItem) {\n            if (relatedItem[relationDef.idAttribute] === record[def.foreignKey]) {\n              def.setLocalField(record, relatedItem)\n            }\n          })\n        })\n      })\n    }\n  },\n\n  /**\n   * Retrieve the record with the given primary key.\n   *\n   * @name RethinkDBAdapter#find\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {(string|number)} id Primary key of the record to retrieve.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] TODO\n   * @param {string[]} [opts.with=[]] TODO\n   * @return {Promise}\n   */\n  find (mapper, id, opts) {\n    const self = this\n    let record, op\n    opts || (opts = {})\n    opts.with || (opts.with = [])\n\n    const table = mapper.table || underscore(mapper.name)\n    const relationList = mapper.relationList || []\n    let tasks = [self.waitForTable(table, opts)]\n\n    relationList.forEach(function (def) {\n      const relationName = def.relation\n      const relationDef = def.getRelation()\n      if (!opts.with || opts.with.indexOf(relationName) === -1) {\n        return\n      }\n      if (def.foreignKey && def.type !== 'belongsTo') {\n        if (def.type === 'belongsTo') {\n          tasks.push(self.waitForIndex(mapper.table || underscore(mapper.name), def.foreignKey, opts))\n        } else {\n          tasks.push(self.waitForIndex(relationDef.table || underscore(relationDef.name), def.foreignKey, opts))\n        }\n      }\n    })\n    return Promise.all(tasks).then(function () {\n      // beforeFind lifecycle hook\n      op = opts.op = 'beforeFind'\n      return resolve(self[op](mapper, id, opts)).then(function () {\n        op = opts.op = 'find'\n        self.dbg(op, id, opts)\n        return self.selectTable(mapper, opts).get(id).run()\n      })\n    }).then(function (_record) {\n      if (!_record) {\n        return\n      }\n      record = _record\n      const tasks = []\n\n      forEachRelation(mapper, opts, function (def, __opts) {\n        const relatedMapper = def.getRelation()\n        let task\n\n        if (def.foreignKey && (def.type === 'hasOne' || def.type === 'hasMany')) {\n          if (def.type === 'hasOne') {\n            task = self.loadHasOne(mapper, def, record, __opts)\n          } else {\n            task = self.loadHasMany(mapper, def, record, __opts)\n          }\n        } else if (def.type === 'hasMany' && def.localKeys) {\n          let localKeys = []\n          let itemKeys = get(record, def.localKeys) || []\n          itemKeys = isArray(itemKeys) ? itemKeys : Object.keys(itemKeys)\n          localKeys = localKeys.concat(itemKeys)\n          task = self.findAll(relatedMapper, {\n            where: {\n              [relatedMapper.idAttribute]: {\n                'in': unique(localKeys).filter(function (x) { return x })\n              }\n            }\n          }, __opts).then(function (relatedItems) {\n            def.setLocalField(record, relatedItems)\n          })\n        } else if (def.type === 'hasMany' && def.foreignKeys) {\n          task = self.findAll(relatedMapper, {\n            where: {\n              [def.foreignKeys]: {\n                'contains': get(record, mapper.idAttribute)\n              }\n            }\n          }, __opts).then(function (relatedItems) {\n            def.setLocalField(record, relatedItems)\n          })\n        } else if (def.type === 'belongsTo') {\n          task = self.loadBelongsTo(mapper, def, record, __opts)\n        }\n        if (task) {\n          tasks.push(task)\n        }\n      })\n\n      return Promise.all(tasks)\n    }).then(function () {\n      // afterFind lifecycle hook\n      op = opts.op = 'afterFind'\n      return resolve(self[op](mapper, id, opts, record)).then(function (_record) {\n        // Allow for re-assignment from lifecycle hook\n        record = isUndefined(_record) ? record : _record\n        return self.getRaw(opts) ? {\n          data: record,\n          found: record ? 1 : 0\n        } : record\n      })\n    })\n  },\n\n  /**\n   * Retrieve the records that match the selection query.\n   *\n   * @name RethinkDBAdapter#findAll\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {Object} query Selection query.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] TODO\n   * @param {string[]} [opts.with=[]] TODO\n   * @return {Promise}\n   */\n  findAll (mapper, query, opts) {\n    const self = this\n    opts || (opts = {})\n    opts.with || (opts.with = [])\n\n    let records = []\n    let op\n    const table = mapper.table || underscore(mapper.name)\n    const relationList = mapper.relationList || []\n    let tasks = [self.waitForTable(table, opts)]\n\n    relationList.forEach(function (def) {\n      const relationName = def.relation\n      const relationDef = def.getRelation()\n      if (!opts.with || opts.with.indexOf(relationName) === -1) {\n        return\n      }\n      if (def.foreignKey && def.type !== 'belongsTo') {\n        if (def.type === 'belongsTo') {\n          tasks.push(self.waitForIndex(mapper.table || underscore(mapper.name), def.foreignKey, opts))\n        } else {\n          tasks.push(self.waitForIndex(relationDef.table || underscore(relationDef.name), def.foreignKey, opts))\n        }\n      }\n    })\n    return Promise.all(tasks).then(function () {\n      // beforeFindAll lifecycle hook\n      op = opts.op = 'beforeFindAll'\n      return resolve(self[op](mapper, query, opts))\n    }).then(function () {\n      op = opts.op = 'findAll'\n      self.dbg(op, query, opts)\n      return self.filterSequence(self.selectTable(mapper, opts), query).run()\n    }).then(function (_records) {\n      records = _records\n      const tasks = []\n      forEachRelation(mapper, opts, function (def, __opts) {\n        const relatedMapper = def.getRelation()\n        const idAttribute = mapper.idAttribute\n        let task\n        if (def.foreignKey && (def.type === 'hasOne' || def.type === 'hasMany')) {\n          if (def.type === 'hasMany') {\n            task = self.loadHasMany(mapper, def, records, __opts)\n          } else {\n            task = self.loadHasOne(mapper, def, records, __opts)\n          }\n        } else if (def.type === 'hasMany' && def.localKeys) {\n          let localKeys = []\n          records.forEach(function (item) {\n            let itemKeys = item[def.localKeys] || []\n            itemKeys = isArray(itemKeys) ? itemKeys : Object.keys(itemKeys)\n            localKeys = localKeys.concat(itemKeys)\n          })\n          task = self.findAll(relatedMapper, {\n            where: {\n              [relatedMapper.idAttribute]: {\n                'in': unique(localKeys).filter(function (x) { return x })\n              }\n            }\n          }, __opts).then(function (relatedItems) {\n            records.forEach(function (item) {\n              let attached = []\n              let itemKeys = get(item, def.localKeys) || []\n              itemKeys = isArray(itemKeys) ? itemKeys : Object.keys(itemKeys)\n              relatedItems.forEach(function (relatedItem) {\n                if (itemKeys && itemKeys.indexOf(relatedItem[relatedMapper.idAttribute]) !== -1) {\n                  attached.push(relatedItem)\n                }\n              })\n              def.setLocalField(item, attached)\n            })\n            return relatedItems\n          })\n        } else if (def.type === 'hasMany' && def.foreignKeys) {\n          task = self.findAll(relatedMapper, {\n            where: {\n              [def.foreignKeys]: {\n                'isectNotEmpty': records.map(function (record) {\n                  return get(record, idAttribute)\n                })\n              }\n            }\n          }, __opts).then(function (relatedItems) {\n            const foreignKeysField = def.foreignKeys\n            records.forEach(function (record) {\n              const _relatedItems = []\n              const id = get(record, idAttribute)\n              relatedItems.forEach(function (relatedItem) {\n                const foreignKeys = get(relatedItems, foreignKeysField) || []\n                if (foreignKeys.indexOf(id) !== -1) {\n                  _relatedItems.push(relatedItem)\n                }\n              })\n              def.setLocalField(record, _relatedItems)\n            })\n          })\n        } else if (def.type === 'belongsTo') {\n          task = self.loadBelongsTo(mapper, def, records, __opts)\n        }\n        if (task) {\n          tasks.push(task)\n        }\n      })\n      return Promise.all(tasks)\n    }).then(function () {\n      // afterFindAll lifecycle hook\n      op = opts.op = 'afterFindAll'\n      return resolve(self[op](mapper, query, opts, records)).then(function (_records) {\n        // Allow for re-assignment from lifecycle hook\n        records = isUndefined(_records) ? records : _records\n        return self.getRaw(opts) ? {\n          data: records,\n          found: records.length\n        } : records\n      })\n    })\n  },\n\n  /**\n   * TODO\n   *\n   * @name RethinkDBAdapter#getRaw\n   * @method\n   */\n  getRaw (opts) {\n    opts || (opts = {})\n    return !!(isUndefined(opts.raw) ? this.raw : opts.raw)\n  },\n\n  /**\n   * TODO\n   *\n   * @name RethinkDBAdapter#log\n   * @method\n   */\n  log (level, ...args) {\n    if (level && !args.length) {\n      args.push(level)\n      level = 'debug'\n    }\n    if (level === 'debug' && !this.debug) {\n      return\n    }\n    const prefix = `${level.toUpperCase()}: (RethinkDBAdapter)`\n    if (console[level]) {\n      console[level](prefix, ...args)\n    } else {\n      console.log(prefix, ...args)\n    }\n  },\n\n  /**\n   * Apply the given update to the record with the specified primary key.\n   *\n   * @name RethinkDBAdapter#update\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {(string|number)} id The primary key of the record to be updated.\n   * @param {Object} props The update to apply to the record.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] TODO\n   * @return {Promise}\n   */\n  update (mapper, id, props, opts) {\n    const self = this\n    props || (props = {})\n    opts || (opts = {})\n    let op\n\n    return self.waitForTable(mapper.table || underscore(mapper.name), opts).then(function () {\n      // beforeUpdate lifecycle hook\n      op = opts.op = 'beforeUpdate'\n      return resolve(self[op](mapper, id, props, opts))\n    }).then(function (_props) {\n      // Allow for re-assignment from lifecycle hook\n      _props = isUndefined(_props) ? props : _props\n      return self.selectTable(mapper, opts).get(id).update(_props, { returnChanges: true }).run()\n    }).then(function (cursor) {\n      let record\n      self._handleErrors(cursor)\n      if (cursor && cursor.changes && cursor.changes.length && cursor.changes[0].new_val) {\n        record = cursor.changes[0].new_val\n      } else {\n        throw new Error('Not Found')\n      }\n\n      // afterUpdate lifecycle hook\n      op = opts.op = 'afterUpdate'\n      return resolve(self[op](mapper, id, props, opts, record)).then(function (_record) {\n        // Allow for re-assignment from lifecycle hook\n        record = isUndefined(_record) ? record : _record\n        const result = {}\n        fillIn(result, cursor)\n        result.data = record\n        result.updated = record ? 1 : 0\n        return self.getRaw(opts) ? result : result.data\n      })\n    })\n  },\n\n  /**\n   * Apply the given update to all records that match the selection query.\n   *\n   * @name RethinkDBAdapter#updateAll\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {Object} props The update to apply to the selected records.\n   * @param {Object} [query] Selection query.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] TODO\n   * @return {Promise}\n   */\n  updateAll (mapper, props, query, opts) {\n    const self = this\n    props || (props = {})\n    query || (query = {})\n    opts || (opts = {})\n    let op\n\n    return self.waitForTable(mapper.table || underscore(mapper.name), opts).then(function () {\n      // beforeUpdateAll lifecycle hook\n      op = opts.op = 'beforeUpdateAll'\n      return resolve(self[op](mapper, props, query, opts))\n    }).then(function (_props) {\n      // Allow for re-assignment from lifecycle hook\n      _props = isUndefined(_props) ? props : _props\n      return self.filterSequence(self.selectTable(mapper, opts), query).update(_props, { returnChanges: true }).run()\n    }).then(function (cursor) {\n      let records = []\n      self._handleErrors(cursor)\n      if (cursor && cursor.changes && cursor.changes.length) {\n        records = cursor.changes.map(function (change) { return change.new_val })\n      }\n      // afterUpdateAll lifecycle hook\n      op = opts.op = 'afterUpdateAll'\n      return self[op](mapper, props, query, opts, records).then(function (_records) {\n        // Allow for re-assignment from lifecycle hook\n        records = isUndefined(_records) ? records : _records\n        const result = {}\n        fillIn(result, cursor)\n        result.data = records\n        result.updated = records.length\n        return self.getRaw(opts) ? result : result.data\n      })\n    })\n  },\n\n  /**\n   * Update the given records in a single batch.\n   *\n   * @name RethinkDBAdapter#updateMany\n   * @method\n   * @param {Object} mapper The mapper.\n   * @param {Object[]} records The records to update.\n   * @param {Object} [opts] Configuration options.\n   * @param {boolean} [opts.raw=false] TODO\n   * @return {Promise}\n   */\n  updateMany (mapper, records, opts) {\n    const self = this\n    records || (records = [])\n    opts || (opts = {})\n    let op\n    const idAttribute = mapper.idAttribute\n\n    records = records.filter(function (record) {\n      return get(record, idAttribute)\n    })\n\n    return self.waitForTable(mapper.table || underscore(mapper.name), opts).then(function () {\n      // beforeUpdateMany lifecycle hook\n      op = opts.op = 'beforeUpdateMany'\n      return resolve(self[op](mapper, records, opts))\n    }).then(function (_records) {\n      // Allow for re-assignment from lifecycle hook\n      _records = isUndefined(_records) ? records : _records\n      return self.selectTable(mapper, opts).insert(_records, { returnChanges: true, conflict: 'update' }).run()\n    }).then(function (cursor) {\n      let updatedRecords\n      self._handleErrors(cursor)\n      if (cursor && cursor.changes && cursor.changes.length) {\n        updatedRecords = cursor.changes.map(function (change) { return change.new_val })\n      }\n\n      // afterUpdateMany lifecycle hook\n      op = opts.op = 'afterUpdateMany'\n      return resolve(self[op](mapper, records, opts, updatedRecords)).then(function (_records) {\n        // Allow for re-assignment from lifecycle hook\n        records = isUndefined(_records) ? updatedRecords : _records\n        const result = {}\n        fillIn(result, cursor)\n        result.data = records\n        result.updated = records.length\n        return self.getRaw(opts) ? result : result.data\n      })\n    })\n  },\n\n  waitForTable (table, options) {\n    options = options || {}\n    let db = isUndefined(options.db) ? this.db : options.db\n    return this.waitForDb(options).then(() => {\n      this.tables[db] = this.tables[db] || {}\n      if (!this.tables[db][table]) {\n        this.tables[db][table] = this.r.branch(this.r.db(db).tableList().contains(table), true, this.r.db(db).tableCreate(table)).run()\n      }\n      return this.tables[db][table]\n    })\n  },\n\n  waitForIndex (table, index, options) {\n    options = options || {}\n    let db = isUndefined(options.db) ? this.db : options.db\n    return this.waitForDb(options).then(() => this.waitForTable(table, options)).then(() => {\n      this.indices[db] = this.indices[db] || {}\n      this.indices[db][table] = this.indices[db][table] || {}\n      if (!this.tables[db][table][index]) {\n        this.tables[db][table][index] = this.r.branch(this.r.db(db).table(table).indexList().contains(index), true, this.r.db(db).table(table).indexCreate(index)).run().then(() => {\n          return this.r.db(db).table(table).indexWait(index).run()\n        })\n      }\n      return this.tables[db][table][index]\n    })\n  }\n})\n"],"names":["utils"],"mappings":"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"}